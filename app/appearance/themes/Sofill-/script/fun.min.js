import*as API from"./utils/api.min.js";function InsertMenuItem(e,t){let n=document.getElementById("commonMenu"),s=n.querySelector(".b3-menu__item--readonly"),u=n.querySelector('[id="viewselect"]');s&&(u||(n.insertBefore(ViewSelect(e,t),s),n.insertBefore(MenuSeparator(),s)))}function ViewMonitor(e){let t=e.currentTarget.getAttribute("data-node-id"),n="custom-"+e.currentTarget.getAttribute("custom-attr-name"),s=e.currentTarget.getAttribute("custom-attr-value"),u=document.querySelectorAll(`.protyle-wysiwyg [data-node-id="${t}"]`);u&&u.forEach((e=>e.setAttribute(n,s)));let a={};a[n]=s,API.setBlockAttrs(t,a)}function ViewSelect(e,t){let n=document.createElement("button");return n.id="viewselect",n.className="b3-menu__item",n.innerHTML='<svg class="b3-menu__icon" style="null"><use xlink:href="#iconGlobalGraph"></use></svg><span class="b3-menu__label" style="">视图选择</span><svg class="b3-menu__icon b3-menu__icon--arrow" style="null"><use xlink:href="#iconRight"></use></svg></button>',n.appendChild(SubMenu(e,t)),n}function SubMenu(e,t,n="b3-menu__submenu"){let s=document.createElement("div");return s.className=n,"NodeList"==t&&(s.appendChild(ScrollView31(e)),s.appendChild(ScrollView58(e)),s.appendChild(ScrollViewNull(e)),s.appendChild(GraphView(e)),s.appendChild(TableView(e)),s.appendChild(kanbanView(e)),s.appendChild(DefaultView(e))),"NodeTable"==t&&(s.appendChild(ScrollView31(e)),s.appendChild(ScrollView58(e)),s.appendChild(ScrollViewNull(e))),"NodeSuperBlock"!=t&&"NodeBlockQueryEmbed"!=t&&"NodeCodeBlock"!=t||(s.appendChild(ScrollView31(e)),s.appendChild(ScrollView58(e)),s.appendChild(ScrollViewNull(e))),s}function ScrollView31(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","render"),t.setAttribute("custom-attr-value","scroll scroll31"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconScrollWrapped"></use></svg><span class="b3-menu__label">滚屏显示 31%</span>',t.onclick=ViewMonitor,t}function ScrollView58(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","render"),t.setAttribute("custom-attr-value","scroll scroll58"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconScrollWrapped"></use></svg><span class="b3-menu__label">滚屏显示 58%</span>',t.onclick=ViewMonitor,t}function ScrollViewNull(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","render"),t.setAttribute("custom-attr-value",""),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconScrollWrapped"></use></svg><span class="b3-menu__label">取消滚屏显示</span>',t.onclick=ViewMonitor,t}function GraphView(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value","dt"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconFiles"></use></svg><span class="b3-menu__label">转换为导图</span>',t.onclick=ViewMonitor,t}function TableView(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value","bg"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconTable"></use></svg><span class="b3-menu__label">转换为表格</span>',t.onclick=ViewMonitor,t}function kanbanView(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value","kb"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconMenu"></use></svg><span class="b3-menu__label">转换为看板</span>',t.onclick=ViewMonitor,t}function DefaultView(e){let t=document.createElement("button");return t.className="b3-menu__item",t.onclick=ViewMonitor,t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value",""),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconList"></use></svg><span class="b3-menu__label">恢复为列表</span>',t}function FixWidth(e){let t=document.createElement("button");return t.className="b3-menu__item",t.onclick=ViewMonitor,t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value",""),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconTable"></use></svg><span class="b3-menu__label">自动宽度(换行)</span>',t}function AutoWidth(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value","auto"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconTable"></use></svg><span class="b3-menu__label">自动宽度(不换行)</span>',t.onclick=ViewMonitor,t}function FullWidth(e){let t=document.createElement("button");return t.className="b3-menu__item",t.onclick=ViewMonitor,t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","f"),t.setAttribute("custom-attr-value","full"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconTable"></use></svg><span class="b3-menu__label">页面宽度</span>',t}function dHeader(e){let t=document.createElement("button");return t.className="b3-menu__item",t.onclick=ViewMonitor,t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","t"),t.setAttribute("custom-attr-value","dongjie"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconSuper"></use></svg><span class="b3-menu__label">冻结表头滚屏</span>',t}function vHeader(e){let t=document.createElement("button");return t.className="b3-menu__item",t.onclick=ViewMonitor,t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","t"),t.setAttribute("custom-attr-value","vbiaotou"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconSuper"></use></svg><span class="b3-menu__label">竖向表头样式</span>',t}function Removeth(e){let t=document.createElement("button");return t.className="b3-menu__item",t.onclick=ViewMonitor,t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","t"),t.setAttribute("custom-attr-value","biaotou"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconSuper"></use></svg><span class="b3-menu__label">空白表头样式</span>',t}function Defaultth(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","t"),t.setAttribute("custom-attr-value",""),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconSuper"></use></svg><span class="b3-menu__label">恢复表头样式</span>',t.onclick=ViewMonitor,t}function Error(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","error"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-1f6ab"></use></svg><span class="b3-menu__label">禁止</span>',t.onclick=ViewMonitor,t}function Warn(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","warn"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-26a0"></use></svg><span class="b3-menu__label">警告</span>',t.onclick=ViewMonitor,t}function Bug(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","bug"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-1f41b"></use></svg><span class="b3-menu__label">bug</span>',t.onclick=ViewMonitor,t}function Check(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","check"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-2705"></use></svg><span class="b3-menu__label">正确</span>',t.onclick=ViewMonitor,t}function Light(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","light"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-1f4a1"></use></svg><span class="b3-menu__label">灵感</span>',t.onclick=ViewMonitor,t}function Question(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","question"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-2753"></use></svg><span class="b3-menu__label">问题</span>',t.onclick=ViewMonitor,t}function Wrong(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","wrong"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-274c"></use></svg><span class="b3-menu__label">错误</span>',t.onclick=ViewMonitor,t}function Info(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","info"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-2139"></use></svg><span class="b3-menu__label">信息</span>',t.onclick=ViewMonitor,t}function Pen(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","pen"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-1f58b"></use></svg><span class="b3-menu__label">记录</span>',t.onclick=ViewMonitor,t}function Note(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","note"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-1f4d3"></use></svg><span class="b3-menu__label">汇总</span>',t.onclick=ViewMonitor,t}function Bell(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value","bell"),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#icon-1f514"></use></svg><span class="b3-menu__label">提醒</span>',t.onclick=ViewMonitor,t}function Defaultbq(e){let t=document.createElement("button");return t.className="b3-menu__item",t.setAttribute("data-node-id",e),t.setAttribute("custom-attr-name","b"),t.setAttribute("custom-attr-value",""),t.innerHTML='<svg class="b3-menu__icon" style=""><use xlink:href="#iconRefresh"></use></svg><span class="b3-menu__label">恢复默认样式</span>',t.onclick=ViewMonitor,t}function MenuSeparator(e="b3-menu__separator"){let t=document.createElement("button");return t.className=e,t}window.sofill.funs.getThemeMode=(()=>{switch(window.siyuan.config.appearance.mode){case 0:return"light";case 1:return"dark";default:return null}})(),window.sofill.funs.MenuShow=function(){setTimeout((()=>{let e=API.getBlockSelected();if(e){let t=e.type,n=e.id;"true"==e.parentNode.getAttribute("contenteditable")&&InsertMenuItem(n,t)}}),0)},setTimeout((()=>window.addEventListener("mouseup",window.sofill.funs.MenuShow)),200);